<div class="p-4">
    <div class="mapping-info">
        <div class="text-center mb-4">
            <i
                class="pi pi-info-circle text-blue-500"
                style="font-size: 3rem"
            ></i>
            <h3 class="mt-2 mb-0 text-blue-700">Survey Point Mapping</h3>
        </div>

        <div class="mapping-details bg-blue-50 p-3 border-round">
            <div class="detail-row">
                <strong>Survey UUID:</strong>
                <span class="text-primary">{{ surveyDataItem.ec5_uuid }}</span>
            </div>

            <p-divider></p-divider>

            <div class="detail-row">
                <strong>Building ID:</strong>
                <span class="text-primary">{{ buildingId }}</span>
            </div>

            <div class="detail-row" *ngIf="buildingName">
                <strong>ELE Building Name:</strong>
                <span>{{ buildingName }}</span>
            </div>
            <div class="detail-row">
                <strong>EPICOLLECT Building Name:</strong>
                <span>{{ surveyDataItem["2_Owners_Name"] }}</span>
            </div>

            <div class="detail-row" *ngIf="buildingAddress">
                <strong>Building Address:</strong>
                <span>{{ buildingAddress }}</span>
            </div>

            <div class="detail-row" *ngIf="surveyDataItem && epicollectHelper">
                <strong>Survey Photos:</strong>
                <div class="text-sm text-gray-600 mt-1">
                    Photos will be automatically downloaded from EpiCollect and
                    uploaded to the building record.
                </div>
                <div class="flex flex-wrap gap-1 mt-2">
                    <p-chip
                        label="Sketch Plan"
                        icon="pi pi-image"
                        styleClass="p-chip-sm"
                        *ngIf="surveyDataItem['40_Sketch_a_plan_of_']"
                    >
                    </p-chip>
                    <p-chip
                        label="Front Side"
                        icon="pi pi-image"
                        styleClass="p-chip-sm"
                        *ngIf="surveyDataItem['41_Front_side_photo_']"
                    >
                    </p-chip>
                    <p-chip
                        label="Left Side"
                        icon="pi pi-image"
                        styleClass="p-chip-sm"
                        *ngIf="surveyDataItem['42_Left_side_photo_o']"
                    >
                    </p-chip>
                    <p-chip
                        label="Back Side"
                        icon="pi pi-image"
                        styleClass="p-chip-sm"
                        *ngIf="surveyDataItem['43_Back_side_photo_o']"
                    >
                    </p-chip>
                    <p-chip
                        label="Right Side"
                        icon="pi pi-image"
                        styleClass="p-chip-sm"
                        *ngIf="surveyDataItem['44_Right_side_photo_']"
                    >
                    </p-chip>
                    <p-chip
                        label="Special Photo 1"
                        icon="pi pi-image"
                        styleClass="p-chip-sm"
                        *ngIf="surveyDataItem['45_Photo_of_any_spec']"
                    >
                    </p-chip>
                    <p-chip
                        label="Special Photo 2"
                        icon="pi pi-image"
                        styleClass="p-chip-sm"
                        *ngIf="surveyDataItem['46_Photo_of_any_spec']"
                    >
                    </p-chip>
                </div>
            </div>
        </div>

        <div class="mt-4 p-3 bg-yellow-50 border-round">
            <div class="flex align-items-center">
                <i class="pi pi-exclamation-triangle text-yellow-600 mr-2"></i>
                <span class="text-yellow-800">
                    This action will map the survey point to the selected
                    building<span *ngIf="surveyDataItem && epicollectHelper">
                        and download/upload any available survey photos</span
                    >. Do you want to proceed?
                </span>
            </div>
        </div>

        <div *ngIf="isUploading" class="mt-3 p-3 bg-blue-50 border-round">
            <div class="flex align-items-center">
                <i class="pi pi-spin pi-spinner text-blue-600 mr-2"></i>
                <span class="text-blue-800">
                    Uploading photos... Please wait.
                </span>
            </div>
        </div>
    </div>

    <div class="flex justify-content-end gap-2 mt-4">
        <p-button
            label="Cancel"
            severity="secondary"
            outlined
            [disabled]="isUploading"
            (click)="close(false)"
        ></p-button>
        <p-button
            [label]="isUploading ? 'Uploading...' : 'Confirm Mapping'"
            severity="primary"
            [icon]="isUploading ? 'pi pi-spin pi-spinner' : 'pi pi-check'"
            [disabled]="isUploading"
            (click)="confirm()"
        ></p-button>
    </div>
</div>
